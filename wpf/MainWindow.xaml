<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ag="clr-namespace:WpfAutoGrid;assembly=WpfAutoGrid" x:Class="TsActivexGen.wpf.MainWindow">
    <Window.Resources>
        <Style TargetType="{x:Type DataGridCell}">
            <Setter Property="ToolTip" Value="{Binding RegistryKey}" />
        </Style>
        <ToolTip x:Key="ttOutput">
            Path to output generated files. Will be created if it doesn't exist.
        </ToolTip>
        <ToolTip x:Key="ttCreateTestFile">
            DefinitelyTyped requires a test file that uses the declarations. Check this box to create such a tests file.
        </ToolTip>
        <TextBlock x:Key="ttVarDateHandling">
            Automation dates are returned as the VarDate type, which need to be passed into the Date constructor before they can be used.
            <LineBreak />
            *  If the interface is already defined (in a different file, or using Typescript >= 2.0), don't generate
            <LineBreak />
            Otherwise, the interface can be generated in:
            <LineBreak />
            * an external file, or
            <LineBreak />
            * within the generated file
        </TextBlock>
    </Window.Resources>
    <DockPanel>
        <TabControl TabStripPlacement="Left">
            <TabItem Header="Registered type libraries" IsSelected="True">
                <DockPanel>
                    <ag:AutoGrid DockPanel.Dock="Bottom" Columns="Auto,*" RowCount="5" x:Name="autogrid">
                        <Label Content="Output folder" ToolTip="{StaticResource ttOutput}" />
                        <DockPanel ToolTip="{StaticResource ttOutput}">
                            <Button Content="..." Name="btnBrowseOutputFolder" DockPanel.Dock="Right" />
                            <TextBox x:Name="txbOutput" />
                        </DockPanel>
                        <Label Content="Filename" />
                        <DockPanel>
                            <TextBlock Text=".d.ts" DockPanel.Dock="Right" />
                            <TextBox x:Name="txbFilename" />
                        </DockPanel>
                        <Label Content="Create tests file" ToolTip="{StaticResource ttCreateTestFile}" />
                        <CheckBox IsChecked="True" Name="chkOutputTests" ToolTip="{StaticResource ttCreateTestFile}" />
                        <Label Content="VarDate interface location" ToolTip="{StaticResource ttVarDateHandling}" />
                        <ComboBox Name="cmbVarDateHandling" SelectedValuePath="Content" SelectedIndex="0" ToolTip="{StaticResource ttVarDateHandling}" />
                        <Button Name="btnOutput" Content="Output" Grid.ColumnSpan="2" />
                    </ag:AutoGrid>
                    <DockPanel DockPanel.Dock="Top">
                        <TextBlock Text="Filter text:" />
                        <TextBox x:Name="txbFilter" />
                    </DockPanel>
                    <DataGrid x:Name="dgTypeLibs" AutoGenerateColumns="False" CanUserSortColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Name}" Header="Name" />
                            <DataGridTextColumn Binding="{Binding Version}" Header="Version" />
                            <DataGridCheckBoxColumn Binding="{Binding Is32bit}" Header="32-bit" />
                            <DataGridCheckBoxColumn Binding="{Binding Is64bit}" Header="64-bit" />
                            <DataGridTextColumn Binding="{Binding LCID}" Header="LCID" />
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
            <TabItem Header="Browse type library">
            </TabItem>
            <TabItem Header="WMI">
                <ListBox x:Name="lbWMIClasses" />
                <!--Fill async-->
            </TabItem>
        </TabControl>
        <DockPanel>
            <ScrollViewer>
                <TextBlock x:Name="tbPreview" Foreground="White" Background="Black" FontSize="16" />
            </ScrollViewer>

        </DockPanel>
    </DockPanel>
</Window>
