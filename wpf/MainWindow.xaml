<Window x:Class="TsActivexGen.Wpf.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ag="clr-namespace:WpfAutoGrid;assembly=WpfAutoGrid" xmlns:my="clr-namespace:TsActivexGen.Wpf" xmlns:s="clr-namespace:System;assembly=mscorlib">
    <Window.Resources>
        <ToolTip x:Key="ttOutput">
            Path to output generated files. Will be created if it doesn't exist.
        </ToolTip>
        <ToolTip x:Key="ttCreateTestFile">
            DefinitelyTyped requires a test file that uses the declarations. Check this box to create such a tests file.
        </ToolTip>
        <Style TargetType="{x:Type ListBoxItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <RadioButton Content="{TemplateBinding Content}" IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsSelected}" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <my:ExistsConverter x:Key="ExistsConverter" />
        <s:Boolean x:Key="True">True</s:Boolean>
        <s:Boolean x:Key="False">False</s:Boolean>
    </Window.Resources>
    <DockPanel>
        <DockPanel>
            <ag:AutoGrid DockPanel.Dock="Top" ColumnCount="2" RowCount="2">
                <Label Content="Source" />
                <my:DefinitionTypesComboBox x:Name="cmbDefinitionType" />
                <Label Content="Filter text" />
                <TextBox x:Name="txbFilter" />
                <!-- more fields in here, for use with @types headers-->
            </ag:AutoGrid>
            <TabControl SelectedIndex="{Binding SelectedIndex,ElementName=cmbDefinitionType}" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Visibility" Value="Collapsed" />
                    </Style>
                </TabControl.Resources>
                <TabItem>
                    <DataGrid x:Name="dgTypeLibs" AutoGenerateColumns="False" CanUserSortColumns="False" IsReadOnly="True">
                        <DataGrid.Resources>
                            <Style TargetType="{x:Type DataGridCell}">
                                <Setter Property="ToolTip" Value="{Binding RegistryKey}" />
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Name}" Header="Name" />
                            <DataGridTextColumn Binding="{Binding Version}" Header="Version" />
                            <DataGridCheckBoxColumn Binding="{Binding Is32bit}" Header="32-bit" />
                            <DataGridCheckBoxColumn Binding="{Binding Is64bit}" Header="64-bit" />
                            <DataGridTextColumn Binding="{Binding LCID}" Header="LCID" />
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>
                <TabItem>
                    <DockPanel VerticalAlignment="Top">
                        <Button Content="..." Name="btnBrowseTypeLibFile" DockPanel.Dock="Right" />
                        <Label Content="Filename" />
                        <TextBox Name="txbTypeLibFromFile" />
                    </DockPanel>
                </TabItem>
                <TabItem>
                    <Button HorizontalAlignment="Center" VerticalAlignment="Center" Content="Load default libraries" Name="btnLoadDefaultLibs" />
                </TabItem>
                <TabItem>
                    WMI classes - not yet implemented
                </TabItem>
            </TabControl>
        </DockPanel>
        <DockPanel>
            <DockPanel DockPanel.Dock="Top">
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
                    <Label Content="Output folder" ToolTip="{StaticResource ttOutput}" />
                    <DockPanel ToolTip="{StaticResource ttOutput}">
                        <Button Content="..." Name="btnBrowseOutputFolder" DockPanel.Dock="Right" />
                        <TextBox x:Name="txbOutputFolder" />
                    </DockPanel>
                </StackPanel>
                <ListBox BorderBrush="{x:Null}" Margin="10" Name="lbPackaging" SelectedValuePath="Tag">
                    <ListBox.Resources>
                        <Style TargetType="{x:Type ListBoxItem}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                        <RadioButton Content="{TemplateBinding Content}" IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsSelected}" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                        <Style TargetType="{x:Type ag:AutoGrid}">
                            <Setter Property="IsEnabled" Value="{Binding RelativeSource={RelativeSource AncestorType=RadioButton}, Path=IsChecked}" />
                        </Style>
                    </ListBox.Resources>
                    <ListBoxItem IsSelected="True" Tag="{StaticResource True}">
                        <StackPanel>
                            <TextBlock>Package for DefinitelyTyped</TextBlock>
                            <ag:AutoGrid RowCount="2" ColumnCount="2" Columns="*,300">
                                <Label Content="Author name" />
                                <TextBox x:Name="txbAuthorName" Text="Zev Spitz" />
                                <Label Content="Author URL" />
                                <TextBox x:Name="txbAuthorURL" Text="https://github.com/zspitz" />
                            </ag:AutoGrid>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="{StaticResource False}">Single file</ListBoxItem>
                </ListBox>
                <UniformGrid Rows="1" Columns="2" Margin="10">
                    <Button Name="btnOutput" Content="Output" />
                    <Button Name="btnClearFiles" Content="Clear file list" />
                </UniformGrid>
            </DockPanel>
            <DataGrid Name="dtgFiles" DockPanel.Dock="Top" AutoGenerateColumns="False" CanUserAddRows="False">
                <DataGrid.Columns>
                    <DataGridCheckBoxColumn Binding="{Binding WriteOutput}" Header="Output" />
                    <DataGridTextColumn Binding="{Binding Name}" Header="Name" />
                    <DataGridTextColumn Binding="{Binding FormattedName}" IsReadOnly="True" />
                    <my:DataGridTextColumnExt Binding="{Binding Output.Description}" IsReadOnly="True" Header="Description" TextTrimming="CharacterEllipsis" />
                    <DataGridTextColumn Binding="{Binding LibraryUrl}" Header="Library URL" />
                    <DataGridCheckBoxColumn Header="Exists">
                        <DataGridCheckBoxColumn.Binding>
                            <MultiBinding Converter="{StaticResource ExistsConverter}" Mode="OneWay">
                                <Binding />
                                <Binding Path="SelectedValue" ElementName="lbPackaging" />
                            </MultiBinding>
                        </DataGridCheckBoxColumn.Binding>
                    </DataGridCheckBoxColumn>
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>
    </DockPanel>
</Window>
