<Window x:Class="TsActivexGen.Wpf.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ag="clr-namespace:WpfAutoGrid;assembly=WpfAutoGrid" xmlns:my="clr-namespace:TsActivexGen.Wpf">
    <Window.Resources>
        <ToolTip x:Key="ttOutput">
            Path to output generated files. Will be created if it doesn't exist.
        </ToolTip>
        <ToolTip x:Key="ttCreateTestFile">
            DefinitelyTyped requires a test file that uses the declarations. Check this box to create such a tests file.
        </ToolTip>
        <ToolTip x:Key="ttWriteModules">
            <TextBlock>
            Modules with constants can be defined using literal types
            <Hyperlink>https://github.com/Microsoft/TypeScript/pull/9407</Hyperlink>
            </TextBlock>
        </ToolTip>
    </Window.Resources>
    <DockPanel>
        <DockPanel>
            <ag:AutoGrid DockPanel.Dock="Top" ColumnCount="2" RowCount="2">
                <Label Content="Source" />
                <my:DefinitionTypesComboBox x:Name="cmbDefinitionType" />
                <Label Content="Filter text" />
                <TextBox x:Name="txbFilter" />
                <!-- more fields in here, for use with @types headers-->
            </ag:AutoGrid>
            <TabControl SelectedIndex="{Binding SelectedIndex,ElementName=cmbDefinitionType}" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Visibility" Value="Collapsed" />
                    </Style>
                </TabControl.Resources>
                <TabItem>
                    <DataGrid x:Name="dgTypeLibs" AutoGenerateColumns="False" CanUserSortColumns="False" IsReadOnly="True">
                        <DataGrid.Resources>
                            <Style TargetType="{x:Type DataGridCell}">
                                <Setter Property="ToolTip" Value="{Binding RegistryKey}" />
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Name}" Header="Name" />
                            <DataGridTextColumn Binding="{Binding Version}" Header="Version" />
                            <DataGridCheckBoxColumn Binding="{Binding Is32bit}" Header="32-bit" />
                            <DataGridCheckBoxColumn Binding="{Binding Is64bit}" Header="64-bit" />
                            <DataGridTextColumn Binding="{Binding LCID}" Header="LCID" />
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>
                <TabItem>
                    <DockPanel VerticalAlignment="Top">
                        <Button Content="..." Name="btnBrowseTypeLibFile" DockPanel.Dock="Right" />
                        <Label Content="Filename" />
                        <TextBox Name="txbTypeLibFromFile" />
                    </DockPanel>
                </TabItem>
                <TabItem>
                    WMI classes - not yet implemented
                </TabItem>
            </TabControl>
        </DockPanel>
        <DockPanel>
            <ag:AutoGrid DockPanel.Dock="Top" RowCount="2" ColumnCount="2">
                <Label Content="Output folder" ToolTip="{StaticResource ttOutput}" />
                <DockPanel ToolTip="{StaticResource ttOutput}">
                    <Button Content="..." Name="btnBrowseOutputFolder" DockPanel.Dock="Right" />
                    <TextBox x:Name="txbOutputFolder" />
                </DockPanel>
                <Label Content="Package for @types" />
                <CheckBox Name="cbPackageForTypes" />
            </ag:AutoGrid>
            <DataGrid Name="dtgFiles" DockPanel.Dock="Top" AutoGenerateColumns="False" CanUserAddRows="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Name}" IsReadOnly="True" Header="Name" />
                    <DataGridTextColumn Binding="{Binding Description}" IsReadOnly="True" Header="Description" />
                    <DataGridTextColumn Binding="{Binding FileName}" Header="Filename" />
                    <DataGridCheckBoxColumn Binding="{Binding Exists, Mode=OneWay}" IsReadOnly="True" Header="Exists" />
                    <DataGridCheckBoxColumn Binding="{Binding WriteOutput}" Header="Output" />
                    <DataGridCheckBoxColumn Binding="{Binding PackageForTypings}" Header="@types packaging" />
                </DataGrid.Columns>
            </DataGrid>
            <Button Name="btnOutput" Content="Output" DockPanel.Dock="Top" />
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                <TextBox x:Name="tbPreview" Foreground="White" Background="Black" FontSize="16" Text="{Binding SelectedItem.OutputText,ElementName=dtgFiles}" IsReadOnly="True" />
            </ScrollViewer>
        </DockPanel>
    </DockPanel>
</Window>
