<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ag="clr-namespace:WpfAutoGrid;assembly=WpfAutoGrid" x:Class="TsActivexGen.wpf.MainWindow">
    <Window.Resources>
        <Style TargetType="{x:Type DataGridCell}">
            <Setter Property="ToolTip" Value="{Binding RegistryKey}" />
        </Style>
        <ToolTip x:Key="ttOutput">
            Path to output generated files. Will be created if it doesn't exist.
        </ToolTip>
        <ToolTip x:Key="ttCreateTestFile">
            DefinitelyTyped requires a test file that uses the declarations. Check this box to create such a tests file.
        </ToolTip>
        <ToolTip x:Key="ttWriteModules">
            <TextBlock>
            Modules with constants can be defined using literal types
            <Hyperlink>https://github.com/Microsoft/TypeScript/pull/9407</Hyperlink>
            </TextBlock>
        </ToolTip>
    </Window.Resources>
    <DockPanel>
        <DockPanel>
            <DockPanel DockPanel.Dock="Top" ToolTip="Press SPACE to apply">
                <TextBlock Text="Filter text:" />
                <TextBox x:Name="txbFilter" />
            </DockPanel>
            <ag:AutoGrid DockPanel.Dock="Bottom" Columns="Auto,*" RowCount="6" x:Name="autogrid">
                <Label Content="Output folder" ToolTip="{StaticResource ttOutput}" />
                <DockPanel ToolTip="{StaticResource ttOutput}">
                    <Button Content="..." Name="btnBrowseOutputFolder" DockPanel.Dock="Right" />
                    <TextBox x:Name="txbOutput" />
                </DockPanel>
                <Label Content="Filename" />
                <DockPanel>
                    <TextBlock Text=".d.ts" DockPanel.Dock="Right" />
                    <TextBox x:Name="txbFilename" />
                </DockPanel>
                <Label Content="Create tests file" ToolTip="{StaticResource ttCreateTestFile}" />
                <CheckBox IsChecked="True" Name="chkOutputTests" ToolTip="{StaticResource ttCreateTestFile}" />
                <Label Content="Constant-only modules" ToolTip="{StaticResource ttWriteModules}" />
                <CheckBox IsChecked="False" Name="chkModulesWithConstants" ToolTip="{StaticResource ttWriteModules}" />
                <Button Name="btnOutput" Content="Output" Grid.ColumnSpan="2" />
            </ag:AutoGrid>
            <TabControl TabStripPlacement="Left" Name="tcMain">
                <TabItem Header="Registered type libraries" IsSelected="True">
                    <DataGrid x:Name="dgTypeLibs" AutoGenerateColumns="False" CanUserSortColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Name}" Header="Name" />
                            <DataGridTextColumn Binding="{Binding Version}" Header="Version" />
                            <DataGridCheckBoxColumn Binding="{Binding Is32bit}" Header="32-bit" />
                            <DataGridCheckBoxColumn Binding="{Binding Is64bit}" Header="64-bit" />
                            <DataGridTextColumn Binding="{Binding LCID}" Header="LCID" />
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>
                <TabItem Header="Browse type library">
                    <DockPanel VerticalAlignment="Top">
                        <Button Content="..." Name="btnBrowseTypeLibFile" DockPanel.Dock="Right" />
                        <Label Content="Filename" />
                        <TextBox Name="txbTypeLibFromFile" />
                    </DockPanel>
                </TabItem>
                <TabItem Header="WMI">
                    <ListBox x:Name="lbWMIClasses" />
                    <!--Fill async-->
                </TabItem>
            </TabControl>
        </DockPanel>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
            <TextBox x:Name="tbPreview" Foreground="White" Background="Black" FontSize="16" />
        </ScrollViewer>
    </DockPanel>
</Window>
